<script>
    var dothi1 = <%- JSON.stringify(dothi1) %>;
    var dothi2 = <%- JSON.stringify(dothi2) %>;
    var dothi3 = <%- JSON.stringify(dothi3) %>;
    $(document).ready(function(){
        var tk2=document.querySelectorAll(".thongkeloai2");
        tk2[0].innerHTML="123";
        tk2[1].innerHTML="123";
    })
</script>
<div class="statistical">
    <%  const GuessCity1 = function(city) {%>
        <%temp=1;%>
        <%matdo=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Population"]))*(100+parseFloat(city.DPop))/100)/parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Area"]))*(100+parseFloat(city.AVGAcr))/100);%>
        <%ptkt=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Industry"]))*(100+parseFloat(city.llcreate))/100);%>
        <%while(matdo<2500 || ptkt<10){%>
            <%matdo=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Population"]))*(100+parseFloat(city.DPop)*temp*temp)/100)/parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Area"]))*(100+parseFloat(city.AVGAcr))/100);%>
            <%ptkt=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Industry"]))*(100+parseFloat(city.llcreate)*temp)/100);%>
            <%temp++;%>
        <%}%>
        <%return temp;%>
    <%}%>
    <%  const GuessCity2 = function(city) {%>
        <%temp=1;%>
        <%matdo=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Population"]))*(100+parseFloat(city.DPop))/100)/parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Area"]))*(100+parseFloat(city.AVGAcr))/100);%>
        <%ptkt=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Industry"]))*(100+parseFloat(city.llcreate))/100);%>
        <%while( matdo<2000 || ptkt<8){%>
            <%matdo=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Population"]))*(100+parseFloat(city.DPop)*temp*temp)/100)/parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Area"]))*(100+parseFloat(city.AVGAcr))/100);%>
            <%ptkt=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Industry"]))*(100+parseFloat(city.llcreate)*temp)/100);%>
            <%temp++;%>
        <%}%>
        <%return temp;%>
    <%}%>
    <div class="statistical__analytis">
        <div class="statistical__analytis--main">
            <table>
                <tr class="statistical__analytis__heading">
                    <th>Thành phố</th>
                    <th>Loại đô thị</th>
                    <th>Năm phát triển</th>
                    <th>Dự đoán</th>
                    <th>Hướng phát triển</th>
                </tr>
                <% dothi2.forEach(function(city){ %>
                    <tr>
                        <th>    
                            <%=JSON.stringify(city["City_Year_Polygon.City.Name"])%>
                        </th>
                        <th>
                            Loại 2
                        </th>
                        <th>
                            <%= GuessCity1(city)+2020%>
                        </th>
                        <th>
                            <% var guessyear=GuessCity1(city)%>
                            <% var tdpt=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Industry"]))*(100+parseFloat(city.llcreate)*guessyear)/100)%>
                            <% var tddt=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Area"]))*(100+parseFloat(city.AVGAcr)*guessyear)/100)%>
                            <% var tdds=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Population"]))*(100+parseFloat(city.DPop)*guessyear*guessyear)/100)/tddt%>
                            <p>Mật độ dân số:<%= parseInt(tdds)%> người/km2</p>
                            <p>Tốc độ phát triển kinh tế:<%=tdpt%>%</p>
                            <p>Diện tích: <%=tddt%> km2 </p>
                        </th>
                        <th class="thongkeloai2">
                            
                        </th>
                    </tr>
                <% }) %>
                <% dothi3.forEach(function(city){ %>
                    <tr>
                        <th>    
                            <%=JSON.stringify(city["City_Year_Polygon.City.Name"])%>
                        </th>
                        <th>
                            Loại 3
                        </th>
                        <th>
                            <%-GuessCity2(city)+2020%>
                        </th>
                        <th>
                            <% var guessyear=GuessCity2(city)%>
                            <% var tdpt=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Industry"]))*(100+parseFloat(city.llcreate)*guessyear)/100)%>
                            <% var tddt=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Area"]))*(100+parseFloat(city.AVGAcr)*guessyear)/100)%>
                            <% var tdds=parseInt(parseInt(JSON.stringify(city["City_Year_Polygon.Population"]))*(100+parseFloat(city.DPop)*guessyear*guessyear)/100)/tddt%>
                            <p>Mật độ dân số:<%= parseInt(tdds)%> người/km2</p>
                            <p>Tốc độ phát triển kinh tế:<%=tdpt%>%</p>
                            <%if(tdpt){%>
                                
                            <%}%>
                            <p>Diện tích: <%=tddt%> km2 </p>
                        </th>
                        <th class="thongkeloai3">
                            
                        </th>
                    </tr>
                <% }) %>
            </table>
        </div>
        <div class="statistical__analytis--criteria">
            <h3 class="statistical__analytis--criteria--title">Tiêu chuẩn thành phố</h3>
            <h5 class="statistical__analytis--criteria--city">Thành phố loại 1:</h5>
            <p class="statistical__analytis--criteria--detail">Mật độ dân số: Đạt 2500 người/km2</p>
            <p class="statistical__analytis--criteria--detail">Phát triển kinh tế: Đạt 10%</p>
            <h5 class="statistical__analytis--criteria--city">Thành phố loại 2: </h5>
            <p class="statistical__analytis--criteria--detail">Mật độ dân số: Đạt 2000 người/km2</p>
            <p class="statistical__analytis--criteria--detail">Phát triển kinh tế: Đạt 8%</p>
            <!-- <h5 class="statistical__analytis--criteria--city">Thành phố loại 3:</h5>
            <p class="statistical__analytis--criteria--detail">Mật độ dân số: </p>
            <p class="statistical__analytis--criteria--detail">Phát triển ktế: </p> -->
        </div>
    </div>
</div>